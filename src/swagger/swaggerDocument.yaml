openapi: 3.0.0
info: 
  title: GUIA-TURISTICO-MARANHÃO
    version: 1.0.0
  description: 'API que alimenta website de guia de turismo do Maranhão - Desafio 5 Programa Trilhas 2024'
  contact: 
    name: Suporte a Devs
    email: gabrielfelipecarvalho1@gmail.com
  license:
    name: "Lincença: GPLv3"
    url: https://www.gnu.org/licenses/gpl-3.0.html
externalDocs:
  description: Link repositório
  url: https://github.com/Desafio5-Trilhas/ApiGuiaTuristico
tags:
- name: Usuários
  description: Ações quanto ao usuário
- name: Destinos
  description: Ações quanto ao Destino Turístico
- name: Missões
  description: Ações quanto às missões por destino turístico
- name: AcessoHistorico
  description: Ações quanto ao histórico de acesso do usuário aos destinos
- name: MissaoConcluida
  description: Ações quanto as missões concluidas pelo usuario
servers:
  - url: https://api-guia-turistico.vercel.app/
  - url: http://localhost:3000/
paths:
  /api/usuario/signup:
    post:
      tags:
      - Usuários
      summary: Cria um novo usuário
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                email:
                  type: string
                senha:
                  type: string
                documento:
                  type: string
      responses:
        201:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Usuário criado com sucesso."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"       
        422:
          description: Erros de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
  /api/usuario/login:
    post:
      summary: Autentica um usuário existente
      tags:
        - Usuários
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                senha:
                  type: string
      responses:
        200:
          description: Autenticação bem-sucedida
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  acess_token:
                    type: string
        400:
          description: Credenciais Inválidas
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError" 

        401:
          description: 	API Key inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"
  /api/usuario/sendEmail:
    post:
      summary: Envia um email para o nosso suporte da landing page
      tags:
        - Usuários
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                message:
                  type: string
                nameUsuario:
                  type: string  
                where:
                  type: string
      responses:
        200:
          description: E-mail enviado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        400:
          description: Erro durante o envio do e-mail
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

        401:
          description: 	API Key inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError" 
  /api/usuario:
    get:
      summary: Retorna todos os usuários
      tags:
      - Usuários
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Usuario"
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
    delete:
      summary: Deleta usuário
      tags:
      - Usuários
      parameters:
      - name: email
        in: path
        schema: 
          type: string
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Usuário deletado."
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Usuario não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
  /api/usuario/{email}:
    get:
      summary: Retorna informações cadastradas do usuário
      tags:
      - Usuários
      parameters:
      - name: email
        in: path
        schema: 
          type: string
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Usuario"
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Usuario não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
    put:
      summary: Altera as informações cadastradas do usuário
      tags:
      - Usuários
      parameters:
      - name: email
        in: path
        schema: 
          type: string
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Usuario"
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Usuario não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
  
  /api/destino:
    post:
      tags:
      - Destinos
      summary: Cria um novo destino
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                titulo:
                  type: string
                descricao:
                  type: string
      responses:
        201:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Destino criado com sucesso."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"       
        422:
          description: Erros de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
    get:
      summary: Retorna todos os destinos
      tags:
      - Destinos
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Destino"   
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
  /api/destino/{id}:
    put:
      summary: Altera as informações cadastradas do destino
      tags:
      - Destinos
      parameters:
      - name: email
        in: path
        schema: 
          type: string
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                example: 'Destino atualizado.'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Destino não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
    get:
      summary: Retorna informações cadastradas do destino
      tags:
      - Destinos
      parameters:
      - name: id
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_destino:
                    type: integer
                  titulo:
                    type: string
                  descricao:
                    type: string
                  imagens:
                    type: array
                    items:
                      $ref: '#/components/schemas/Imagem'
                  rotas:
                    type: array
                    items:
                      $ref: '#/components/schemas/Rota'
                  missoes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Missao'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Destino não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string  
    delete:
      summary: Deleta destino
      tags:
      - Destinos
      parameters:
      - name: id_destino
        in: path
        schema: 
          type: id
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Destino deletado."
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Usuario não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string 
  /api/destino/pesquisa/{keyword}:
    get:
      summary: Retorna informações cadastradas do destino para pesquisa
      tags:
      - Destinos
      parameters:
      - name: keyword
        in: path
        schema: 
          type: string
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_destino:
                    type: integer
                  titulo:
                    type: string
                  descricao:
                    type: string
                  imagens:
                    type: array
                    items:
                      $ref: '#/components/schemas/Imagem'
                  rotas:
                    type: array
                    items:
                      $ref: '#/components/schemas/Rota'
                  missoes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Missao'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Destino não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string   

  /api/missao:
    post:
      tags:
      - Missões
      summary: Cria uma nova missão
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id_destino:
                  type: integer
                descricao:
                  type: string 
                dica1:
                  type: string
                dica2:
                  type: string             
      responses:
        201:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Missão criada com sucesso."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"       
        422:
          description: Erros de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
    get:
      summary: Retorna todas as missões
      tags:
      - Missões
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Missao"   
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
  /api/missao/{id_missao}:
    put:
      summary: Altera as informações cadastradas da missao
      tags:
      - Missões
      parameters:
      - name: id_missao
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                example: 'Missão atualizada.'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Missão não encontrada."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string        
    delete:
      summary: Deleta missão
      tags:
      - Missões
      parameters:
      - name: id_missão
        in: path
        schema: 
          type: id
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Missão deletada."
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Usuario não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
  /api/missao/id/{id_missao}:
    get:
      summary: Retorna informações cadastradas da missão
      tags:
      - Missões
      parameters:
      - name: id_missao
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Missao'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Missão não encontrada."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string           
  /api/missao/destino/{id_destino}:
    get:
      summary: Retorna informações cadastradas da missão para o destino específico
      tags:
      - Missões
      parameters:
      - name: id_destino
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Missao'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Missão não encontrada."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string     

  /api/acesso-historico:
    post:
      tags:
      - AcessoHistorico
      summary: Cria um novo histórico de acesso
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id_destino:
                  type: integer
                id_usuario:
                  type: integer 
                data_acesso:
                  type: string       
      responses:
        201:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Histórico de acesso criado com sucesso."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"       
        422:
          description: Erros de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string 
  /api/acesso-historio/{id_usuario}:
    get:
      summary: Retorna informações do historico de acesso do usuario aos destinos
      tags:
      - AcessoHistorico
      parameters:
      - name: id_usuario
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id_acesso_historico:
                      type: integer
                    id_destino:
                      type: integer
                    id_usuario:
                      type: integer
                    data_acesso:
                      type: string
                      format: date-time
                    destinos:
                      $ref: '#/components/schemas/Destino'
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Histórico de acesso não encontrado."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string          
                    
  /api/missao-concluida:
    post:
      tags:
      - MissaoConcluida
      summary: Registra uma missao concluída
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data_finalizacao: 
                  type: string
                  format: date-time
                ultima_dica:
                  type: string
                id_missao:
                  type: integer
                id_usuario:
                  type: integer 
                id_destino:
                  type: integer       
      responses:
        201:
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Missão concluída registrada."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"       
        422:
          description: Erros de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string 
  /api/missao-concluida/{id_usuario}:
    get:
      summary: Retorna informações do historico de acesso do usuario aos destinos
      tags:
      - MissaoConcluida
      parameters:
      - name: id_usuario
        in: path
        schema: 
          type: integer
        required: true
      responses:
        200:
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MissaoConcluida"  
        404:
          description: Falha ao executar
          content:
            application/json:
              example: "Não há missões concluídas."
        403:
          description: API Key não fornecida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        401:
          description: API Key inválida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyError"   
        500:
          description: Internal Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string          
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
      description: API Key necessária para autenticação
  schemas:
    Usuario:
      type: object
      properties:
        id_usuario:
          type: integer
        nome:
          type: string
        email:
          type: string
        status_conta:
          type: string
        documento:
          type: string
    Destino:
      type: object
      properties:
        id_destino:
          type: integer
        titulo: 
          type: string
        descricao:
          type: string
      schemas:
    Imagem:
      type: object
      properties:
        id_imagem:
          type: integer
        link:
          type: string
          format: uri
        id_destino:
          type: integer
    Rota:
      type: object
      properties:
        id_rota:
          type: integer
        id_destino:
          type: integer
        nome:
          type: string
        tipo:
          type: string
    Missao:
      type: object
      properties:
        id_missao:
          type: integer
        id_destino:
          type: integer
        descricao:
          type: string
        dica1:
          type: string
        dica2: 
          type: string
    AcessoHistorico:
      type: object
      properties:
        id_acessoHistorico:
          type: integer
        id_destino:
          type: integer
        id_usuario:
          type: integer
        data_acesso:
          type: string
    MissaoConcluida:
      type: object
      properties:
        id_missao_concluida:
          type: integer
        data_finalizacao:
          type: string
          format: date-time
        ultima_dica:
          type: string
        id_missao:
          type: integer
        id_usuario:
          type: integer
        id_destino:
          type: integer
    ApiKeyError:
      type: object
      properties:
        error:
          type: string  

security:
  - ApiKeyAuth: []